---
title: Environment Variables
---

Rollipop supports loading environment variables from `.env` files. This allows you to define environment-specific configuration that can be accessed in your application code.

Rollipop exposes environment variables through a special `import.meta.env` object, which is statically replaced during bundling for optimal performance.

```ts
if (import.meta.env.MODE === 'development') {
  // code inside here will be tree-shaken in production builds
  console.log('Development Mode');
}
```

## Built-in Constants

Some built-in constants are available in all cases:

- `import.meta.env.MODE` (`string`): The [mode](/docs/get-started/configuration#mode) the app is running in.
- `import.meta.env.BASE_URL` (`?string`): The base url the app is being served from.

## Environment Files

Rollipop loads environment variables from the following files in your project root:

```
.env                # Loaded in all cases
.env.local          # Loaded in all cases, ignored by git
.env.[mode]         # Only loaded in specified mode
.env.[mode].local   # Only loaded in specified mode, ignored by git
```

### Priority Order

Environment variables are loaded and merged in the following order, with later files taking precedence:

1. `.env`
2. `.env.local`
3. `.env.[mode]` (e.g., `.env.development`, `.env.production`)
4. `.env.[mode].local`

Variables defined in files loaded later will override those defined earlier.

## Variable Prefix

By default, only environment variables prefixed with `ROLLIPOP_` are exposed to your application code. This prevents accidentally exposing sensitive environment variables.

```bash title=".env"
ROLLIPOP_API_URL=https://api.example.com
ROLLIPOP_FEATURE_FLAG=true
SECRET_KEY=abc123  # This will NOT be exposed
```

In your application code:

```ts title="App.tsx"
console.log(import.meta.env.ROLLIPOP_API_URL); // https://api.example.com
console.log(import.meta.env.SECRET_KEY); // undefined
```

## Variable Expansion

Rollipop supports variable expansion using the `dotenv-expand` library. You can reference other environment variables within your `.env` files:

```bash title=".env"
ROLLIPOP_API_BASE=https://api.example.com
ROLLIPOP_API_URL=${ROLLIPOP_API_BASE}/v1
ROLLIPOP_API_FULL_URL=${ROLLIPOP_API_URL}/users
```

## Configuration

You can customize the environment file location and variable prefix using the [`envDir`](/docs/get-started/configuration#envdir) and [`envPrefix`](/docs/get-started/configuration#envprefix) options:

```ts title="rollipop.config.ts"
import { defineConfig } from 'rollipop';

export default defineConfig({
  envDir: './config',     // Load .env files from ./config directory
  envPrefix: 'MY_APP_',   // Only expose variables with MY_APP_ prefix
});
```

## Mode-Specific Variables

The `mode` option determines which mode-specific environment files are loaded. By default:

- `development` mode for `rollipop start`
- `production` mode for `rollipop bundle`

```bash title=".env.development"
ROLLIPOP_API_URL=https://dev-api.example.com
ROLLIPOP_DEBUG=true
```

```bash title=".env.production"
ROLLIPOP_API_URL=https://api.example.com
ROLLIPOP_DEBUG=false
```

You can override the mode in your configuration:

```ts title="rollipop.config.ts"
import { defineConfig } from 'rollipop';

export default defineConfig({
  mode: 'production',
});
```

## TypeScript

For TypeScript projects, you can define types for your environment variables to enable IntelliSense and type checking. Create a `rollipop-env.d.ts` file in your project root:

```ts title="rollipop-env.d.ts"
/// <reference types="rollipop/client" />

interface ImportMetaEnv {
  readonly ROLLIPOP_API_BASE: string;
  readonly ROLLIPOP_API_URL: string;
}

interface ImportMeta {
  readonly env: ImportMetaEnv;
}
```

This configuration provides:

- **Type safety**: TypeScript will check that you're accessing defined environment variables
- **IntelliSense**: Auto-completion for environment variables in your IDE
- **Compile-time errors**: Catch typos and undefined variables before runtime

The `/// <reference types="rollipop/client" />` directive ensures that Rollipop's base type definitions are included in your project.
